{% extends 'baseFront.html.twig' %}

    {% block title %} Nebula Gaming {% endblock %}

{% block content %}

    <style>
        .bg {
            background: #120749 !important;
        }

        .billing-method {
            background: #120749;
            border-radius: 5px;
            padding: 40px 20px 20px;
            margin-bottom: 30px;
            overflow-y: scroll;
            height: 10em;
        }

        .top-img {
            border-radius: 15px;
        }

        .form-check span {
            font-size: 14px;
            line-height: 20px;
            font-weight: bold;
        }

        .cmn-btn {
            font-size: 14px;
            line-height: 21px;
            color: #FFFFFF;
        }

        .qtySelector {
            line-height: 20px;
            height: unset;
        }

        {{ encore_entry_link_tags('app') }}

    </style>

    <section id="tournaments-section">
        <div class="overlay pt-120 pb-120">
            <div class="container wow fadeInUp" style="visibility: visible; animation-name: fadeInUp;">
                <div class="row d-flex justify-content-center">
                    <div class="col-lg-8 text-center">
                        <div class="section-header">
                            <h2 class="title">Browse in Nebula Gaming</h2>
                            <p>Find the perfect tournaments & events for you. Discover gaming news & get to answer multiple Quizzes .</p>
                        </div>
                    </div>
                </div>

                <div class="row mb-40 mp-none">

                    <div class="col-lg-3 col-md-3">
                        <div class="single-input">
                            <span>Type of Post</span>
                            <select style="display: none;" id="typePostFilter" >
                                <option>Type of Posts</option>
                                <option value="Quiz">Quiz</option>
                                <option value="News">News</option>
                                <option value="Events & Tournaments">Events & Tournaments</option>
                            </select>

                        </div>
                    </div>

                    <div class="col-lg-3 col-md-3">
                        <div class="single-input">
                            <span>Search</span>
                            <input type="text" placeholder="Search">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3">
                        <div class="single-input">
                            <span>Team Size</span>
                            <select style="display: none;">
                                <option>Select Team Size</option>
                                <option value="1">Size 1</option>
                                <option value="2">Size 2</option>
                                <option value="3">Size 3</option>
                                <option value="4">Size 4</option>
                            </select><div class="nice-select" tabindex="0"><span class="current">Select Team Size</span><ul class="list"><li data-value="Select Team Size" class="option selected">Select Team Size</li><li data-value="1" class="option">Size 1</li><li data-value="2" class="option">Size 2</li><li data-value="3" class="option">Size 3</li><li data-value="4" class="option">Size 4</li></ul></div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3">
                        <div class="single-input">
                            <span>Entry Fee</span>
                            <select style="display: none;">
                                <option>Select Entry Fee</option>
                                <option value="1">50</option>
                                <option value="2">60</option>
                                <option value="3">70</option>
                                <option value="4">80</option>
                            </select><div class="nice-select" tabindex="0"><span class="current">Select Entry Fee</span><ul class="list"><li data-value="Select Entry Fee" class="option selected">Select Entry Fee</li><li data-value="1" class="option">50</li><li data-value="2" class="option">60</li><li data-value="3" class="option">70</li><li data-value="4" class="option">80</li></ul></div>
                        </div>
                    </div>
                </div>



                {# Events #}

                {% set counter = 0 %}
                {% for eventElem in events %}
                    <div class="single-item">
                        <div class="participants-single" style="border-bottom: 1px solid #32286D">
                            <div class="left-area d-flex align-items-center">
                                <img class="rounded-circle mr-3 mb-2" src={{ asset ('frontTemplate/images/participant-1.png') }} alt="images">
                                <div class="right-side">
                                    <h6>{{ eventElem.event.iduser}}</h6>
                                    <small  class="text-secondary">{{eventElem.event.posteddtm ? eventElem.event.posteddtm|date('D M Y H:i') }}</small>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-2">
                            <div class="col-lg-3 col-md-3 d-flex align-items-center">

                                <img class="top-img" src={{ asset('uploads/' ~ eventElem.event.photopost) }} alt="image">
                            </div>
                            <div class="col-lg-6 col-md-9">
                                <div class="mid-area">
                                    <h4>{{ eventElem.event.titlepost }}</h4>
                                    <span class="mt-3" style="width: 100%;white-space: nowrap;overflow: hidden !important; text-overflow: ellipsis;">{{ eventElem.event.descpost }}</span>
                                    <div class="date-area bg mt-lg-3">
                                        <img src={{ asset ('frontTemplate/images/location-icon.png') }} alt="image" style="width: 5%;">
                                        <span style="font-size: 1.0rem">Location </span>

                                        <span class="time" style="font-size: 1.0rem">{{ eventElem.event.addressevent }}</span>

                                        <a href="{{ path('app_event_map', {'idpost': eventElem.event.idpost}) }}" style="font-size: 0.9rem" target="_blank"> | View Map</a>

                                    </div>
                                    <div class="title-bottom d-flex">

                                        <div class="time-area bg w-50 p-3">
                                            <img src={{ asset ('frontTemplate/images/waitng-icon.png') }} alt="image">
                                            <span style="font-size: 1.0rem">Starts at</span>
                                            <span class="time" style="font-size: 1.0rem">{{ eventElem.event.startdtm ? eventElem.event.startdtm |date('H:i') : ''   }}</span></div>


                                        <div class="date-area bg w-50 p-3">
                                            <img src={{ asset ('frontTemplate/images/waitng-icon.png') }} alt="image">
                                            <span style="font-size: 1.0rem">Ends at</span>
                                            <span class="time" style="font-size: 1.0rem">{{ eventElem.event.enddtm ? eventElem.event.enddtm |date('H:i') : ''   }}</span>
                                        </div>
                                    </div>
                                    <span  style="font-size: 1.0rem">Start Date : {{ eventElem.event.startdtm ? eventElem.event.startdtm|date('D M Y') : ''   }} &nbsp;|&nbsp;  End Date : {{ eventElem.event.enddtm ? eventElem.event.enddtm|date('D M Y') : ''   }}</span>

                                </div>

                                <div class="qtySelector text-center mt-3" style="width: 135px ">
                                    <a href="#" style="display: unset;">

                                        {% if eventElem.isLiked == true %}
                                                <i class="fas fa-thumbs-up decreaseQty"></i>
                                        {% elseif eventElem.isLiked == false %}
                                                <i class="far fa-thumbs-up decreaseQty"></i>
                                        {% endif %}

                                    </a>
                                    <span class="js-likes mt-2" style="font-size: 1.0rem">{{ eventElem.nbLikes }} J'aime</span>
                                </div>

                            </div>
                            <div class="col-lg-3 d-flex align-items-center">
                                <div class="prize-area text-center">
                                    <div class="contain-area">

                                        <h4 class="dollar">{{ eventElem.event.nbticketavailable }} Tickets</h4>
                                        <a href="{{ path('app_event_showFront', {'idpost': eventElem.event.idpost }) }}" class="cmn-btn">View Event</a>
                                        <span class="prize"><img src={{ asset ('frontTemplate/images/waitng-icon.png') }} alt="image">Time is ticking</span>
                                        {% set today = "now"|date('D M Y H:i') %}
                                        {% set datePost = eventElem.event.startdtm ? eventElem.event.startdtm|date('D M Y H:i') %}

                                        {% set difference = date(today).diff(date(datePost))%}
                                        {% set leftDays = difference.days %}
                                        {% if datePost == today %}

                                            <span class="time">1 Day left</span>
                                        {% else %}
                                            {% if leftDays < 31 %}
                                                <p>{{ leftDays }} Days left</p>

                                            {% elseif leftDays > 31 and leftDays < 365  %}
                                                {% set leftMonths = leftDays *  0.032855 %}
                                                <p>{{ leftMonths | round  }} Months left</p>

                                            {% elseif leftDays >= 365 %}
                                                {% set leftYears = leftDays / 365 %}
                                                <p>{{ leftYears | round }} Years left</p>

                                            {% endif %}
                                        {% endif %}
                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>

                    {%  if counter <= events | length %}
                        {% set counter = counter +1  %}
                    {% endif %}
                {% endfor %}

                {# Quiz #}

                {% set counter = 0 %}
                {% for quiz in quizzesOutput %}
                    <div class="single-item">
                        <div class="participants-single" style="border-bottom: 1px solid #32286D">
                            <div class="left-area d-flex align-items-center">
                                <img class="rounded-circle mr-3 mb-2" src={{ asset ('frontTemplate/images/participant-1.png') }} alt="images">
                                <div class="right-side">
                                    <h6>{{ quiz[counter].idpost.iduser }}</h6>
                                    <small  class="text-secondary">{{ quiz[counter].idpost.posteddtm ? quiz[counter].idpost.posteddtm|date('D M Y H:i') }}</small>
                                </div>
                            </div>
                        </div>


                        <div class="row mt-2">
                            <div class="col-lg-3 col-md-3 d-flex align-items-center">
                                <img class="top-img" src={{ asset('uploads/' ~ quiz[counter].idpost.photopost) }} alt="image">
                            </div>
                            <div class="col-lg-9 col-md-9">
                                <div class="mid-area">
                                    <h4>{{ quiz[counter].idpost.titlepost }}</h4>
                                    <span class="mt-3" style="width: 100%;white-space: nowrap;overflow: hidden !important; text-overflow: ellipsis;">{{ quiz[counter].idpost.descpost }}</span>
                                </div>


                            <section id="checkout">
                                <div class="billing-method">
                                    {% for option in quiz  %}
                                    <div class="single-area">
                                        <div class="form-check">
                                            <div class="radio-area">
                                                <input type="radio" style="opacity: unset;" class="form-check-input" name="question{{ quiz[counter].idpost.idpost }}" id="{{ option.idoption }}" value="{{ option.contentoption }}">
                                                <label style="color: #FFFFFF ; font-size: 1.0rem;">{{ option.contentoption }}</label>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </section>

                                <div class="d-flex flex-row-reverse">
                                    <button type="submit" onClick="submitAnswer({{ quiz[counter].idpost.idpost }})" class="cmn-btn">Submit Answer</button>
                                </div>

                            </div>

                        </div>
                    </div>

                    {%  if counter <= quizzesOutput | length %}
                        {% set counter = counter +1  %}
                    {% endif %}
                {% endfor %}

                {# RSS FEED #}
                {% for item in rss %}
                    <div class="single-item">

                        <div class="row mt-2">
                            <div class="col-lg-3 col-md-3 d-flex align-items-center">
                                <img class="top-img" src={{ item.image }} alt="image">
                            </div>
                            <div class="col-lg-9 col-md-9">
                                <div class="mid-area">
                                    <h4>{{ item.title }}</h4>
                                    <span class="mt-3" style="width: 100%;white-space: unset;overflow: hidden !important; text-overflow: ellipsis;">{{ item.description }}</span>
                                </div>


                                <div class="d-flex flex-row-reverse">
                                    <a class="cmn-btn " href={{ item.link }}>View More</a>
                                </div>


                            </div>

                        </div>
                    </div>

                {% endfor %}


            </div>
        </div>
        </div>
    </section>

    <script>
        {{ encore_entry_script_tags('app') }}
    </script>

    <script>
        const submitAnswer = async (questionID) =>  {
            const questionName = "question"+questionID;
            const questionsRadioBoxs = document.getElementsByName(questionName);
            let selectedAnswer = "";
            questionsRadioBoxs.forEach(function(element) {
                if(element.checked) {
                    selectedAnswer = element.value;
                }
            });
            //CHECK IF A QUESTION IS SELECTED

            const { data } = await axios.post('/answer/addAnswer/'+questionID, {
                answer: selectedAnswer
            });
            if (data.status==="ok"){
                Swal.fire({
                    icon: 'success',
                    title: 'Yaay !!',
                    text: 'Your anwser has been submitted !'
                })
            }
            else {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Something went wrong and I feel it !!'
                })
            }
            //RESET THE RADIO BOTTONS
        }
    </script>
{% endblock %}
