{% extends 'back/base.html.twig' %}

{% block title %}Liste des admins{% endblock %}

{% block body %}



    <h1>Liste des admins</h1>
    <div class="pcoded-search-box" style="position: relative; left: 500px">
        <input onkeyup="searchUser()" type="text" id="search" class="form-control" placeholder="Search">
    </div>

    <table class="table" >
        <thead>
            <tr>
                <th>Id</th>
                <th>Nom</th>
                <th>Email</th>
                <th>Tel</th>
                <th>Photo</th>
            </tr>
        </thead>
        <tbody>
        {% for admin in admins %}
            <tr name="elements" id="{{ 'admin'~ admin.id}}">
            {% for tbl_reclamation in tbl_reclamations %}
                <tr>

                    <td>{{ tbl_reclamation.message }}</td>
                    <td>{{ tbl_reclamation.statuscomplaint }}</td>
                    <td>{{ tbl_reclamation.answercomplaint }}</td>
                    <td>
                        <a href="{{ path('app_reclamation_show', {'idcomplaint': tbl_reclamation.idcomplaint}) }}">show</a>
                        <a href="{{ path('app_reclamation_edit', {'idcomplaint': tbl_reclamation.idcomplaint}) }}">edit</a>
                    </td>
                </tr>

        {% else %}
            <tr>
                <td colspan="10">Rien a afficher</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {% block js %}
        <script>
            function searchUser() {
                let searchString = document.getElementById('search').value;
                const elements = document.getElementsByName('elements') //recuperation de la reference du dom (liste des tr)
                if (searchString.length!==0){
                    $.ajax({
                        url: 'admin/search/'+searchString,
                        success: function (data) {
                            for (let i = 0; i < elements.length; i++){
                                elements[i].style.display = "none";
                            }

                            for (let j = 0; j < data.length; j++) {
                                $('#admin'+data[j].id).show('slow');
                            }
                        },
                        error: function (xhr, textStatus, errorThrown) {
                            alert("erreur lors de la recuperation des donnÃ©es")
                        }
                    });
                }else{
                    for (let i = 0; i < elements.length; i++){
                        elements[i].style.display = "revert";
                    }
                }
            }
        </script>
    {% endblock %}
{% endblock %}
